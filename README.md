# 얼굴 인식 기반 참석자 계수 프로그램

이 프로젝트는 영상 내 얼굴을 인식하고 분류하여 참석자 계수를 측정하는 Python 기반 프로그램입니다. OpenCV, face_recognition, NumPy 등 다양한 라이브러리가 사용되었습니다.
이 프로젝트는 세 개의 주요 파일로 이루어져 있습니다: `face_classifier.py`, `person_db.py`, `visit_telegram_bot.py`.

## face_classifier.py

얼굴을 분류하고 인식하는 핵심 기능을 담고 있는 클래스인 `FaceClassifier`를 정의합니다. 다음과 같은 주요 기능들이 있습니다:

- **얼굴 위치 파악**: 이미지에서 얼굴의 위치를 파악합니다.
- **얼굴 인식**: 이미지에서 얼굴을 인식하고 해당 얼굴을 `Face` 객체로 생성합니다.
- **기존 얼굴과 비교**: 이미 알려진 얼굴과 비교하여 일치 여부를 확인하고 기존에 있던 얼굴이면 카운트 1회 증가, 새로운 얼굴이면 person_#으로 새롭게 넘버링하여 저장하고 카운트합니다.
- **얼굴 이름 표시**: 인식된 얼굴에 이름을 표시하여 시각적으로 나타냅니다.

이 외에도 옵션 설정 및 프레임 처리 등의 기능이 포함되어 있습니다.

## person_db.py

얼굴 인코딩을 관리하고 개별 얼굴을 특정 개인과 연결하는 클래스인 `Face`와 `Person`을 정의합니다. 또한, 이 정보들을 관리하는 `PersonDB` 클래스가 있습니다. 각 클래스의 주요 기능은 다음과 같습니다:

- **Face 클래스**: 얼굴의 파일명, 이미지, 얼굴 인코딩 등을 관리합니다. 또한, 얼굴 인코딩을 추출하는 `get_encoding` 메서드를 제공합니다.
- **Person 클래스**: 개별 개인을 나타내며, 이름, 얼굴 인코딩, 얼굴 목록 등을 관리합니다. 얼굴을 추가하고, 평균 인코딩을 계산하며, 거리 통계를 얻는 등의 기능이 있습니다.
- **PersonDB 클래스**: 개인들의 데이터베이스를 관리합니다. 이는 알려진 얼굴과 알려지지 않은 얼굴을 구분하여 관리합니다. 데이터베이스의 로딩, 저장, 결과 출력 등을 제공합니다.

## visit_telegram_bot.py

텔레그램 봇을 생성하고 메시지 및 사진을 처리하는 기능을 제공합니다. 주요 기능은 아래와 같습니다.

- `get_message(update, context)`: 사용자가 메시지를 보낼 때 호출되는 함수입니다. 만약 메시지의 길이가 16이라면, 이는 날짜와 시간 범위를 나타내는 메시지로 간주됩니다. 해당 범위 내에서 출입자 수의 통계를 계산하고 반환합니다.
- `help_command(update, context)`: '/help' 명령어를 입력했을 때 호출되는 함수입니다. 사용자에게 통계를 조회하는 방법에 대한 안내를 제공합니다.
- `get_photo(update, context)`: 사용자가 사진을 보낼 때 호출되는 함수입니다. 받은 사진을 지정된 디렉터리에 저장하고, 사용자에게 해당 사진에 대한 이름을 요청합니다. 이 이름과 사진은 `PersonDB`에 등록되어 이후에 프로그램 실행 시 알려진 얼굴로 인식하게 됩니다.

## 사용 방법

프로젝트를 사용하려면 다음과 같은 단계를 따릅니다:

1. `face_classifier.py`와 `person_db.py` 파일을 프로젝트 디렉토리에 복사합니다.
2. 필요한 라이브러리를 설치합니다. (예: `face_recognition`, `opencv-python`)
3. `face_classifier.py`를 실행하여 얼굴 분류 및 인식을 수행합니다.
4. 저장된 통계를 확인하고 싶을 경우 `python visit_telegram_bot.py` 명령어를 사용하여 봇을 실행합니다.
5. `<YYYY.MM.DD.HH-HH>` 형식으로 메시지를 보냅니다. 예를 들어, `2023.10.25.12-14`는 2023년 10월 25일 오후 12시부터 2시까지의 통계를 조회합니다.
